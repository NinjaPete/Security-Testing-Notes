# Potato Attack Privileges Breakdown

## PrintSpoofer (Works Over SMB/WinRM)
[GitHub - PrintSpoofer](https://github.com/itm4n/PrintSpoofer)

**Required Privileges:**  
- **SeImpersonatePrivilege** (Mandatory)  
- **SeAssignPrimaryTokenPrivilege** (Required for creating a new SYSTEM process)  

**Attack Method:**  
- Exploits **Windows Print Spooler Service** via named pipes  
- Works well in **restricted shells** (SMB/WinRM)  
- Works **on Windows Server 2019+**  

**Best Use Case:**  
- Most stable exploit for Windows Server 2019+
- Best for low-privilege SMB/WinRM sessions

---
## SigmaPotato (High Success Rate)
[GitHub - SigmaPotato](https://github.com/tylerdotrar/SigmaPotato/releases)

**Required Privileges:**  
- **SeImpersonatePrivilege** (Mandatory)  

**Best Use Case:**  
- Works on **Windows 10+ & Server 2019+**
- **No external RPC server needed** (stealthier than RoguePotato)

---
## RoguePotato (Bypasses Windows 10+ JuicyPotato Fix)
[Github - RoguePotato](https://github.com/antonioCoco/RoguePotato)

**Required Privileges:**  
- **SeImpersonatePrivilege** (Mandatory)  

**Additional Privileges (Optional but Useful):**  
- **SeAssignPrimaryTokenPrivilege** – Needed to assign SYSTEM token to new processes  
- **SeIncreaseQuotaPrivilege** – Required in some cases for process creation  

**Attack Method:**  
- Redirects **NT AUTHORITY\SYSTEM** token through a fake **RPC** endpoint  
- Bypasses **Windows 10+ JuicyPotato mitigations**  
- Needs an attacker-controlled **listener**  

**Best Use Case:**  
- Windows 10 & Server 2019+
- When JuicyPotato is not an option

---
## JuicyPotato (Classic)
[Github - JuicyPotato](https://github.com/ohpe/juicy-potato)

**Required Privileges:**  
- **SeImpersonatePrivilege** (Mandatory)  

**Additional Privileges (Optional but Useful):**  
- **SeAssignPrimaryTokenPrivilege** – Helps when spawning a SYSTEM shell manually  
- **SeIncreaseQuotaPrivilege** – Ensures stable token assignment  

**Attack Method:**  
- Abuses **DCOM service** to force **NT AUTHORITY\SYSTEM** token delegation  
- Requires **a CLSID associated with SYSTEM services**  
- Doesn't work on Windows 10+ due to mitigations  

**Best Use Case:**  
- Windows Server 2016 or older
- When DCOM-based privilege escalation is still viable

---
## SweetPotato (Local Service to SYSTEM)
[GitHub - SweetPotato](https://github.com/CCob/SweetPotato)

**Required Privileges:**  
- **SeImpersonatePrivilege** (Mandatory)  

**Attack Method:**  
- Targets services running under **LocalService/NetworkService**  
- Useful when Juicy/RoguePotato don’t work  
- Leverages **NTLM reflection attacks**  

**Best Use Case:**  
- When other Potato exploits fail
- Restricted service accounts need escalation

---
## BadPotato (Newer Variant)
[Github - BadPotato](https://github.com/BeichenDream/BadPotato)

**Required Privileges:**  
- **SeImpersonatePrivilege** (Mandatory)  
- **SeTcbPrivilege** (Sometimes required in hardened environments)  

**Attack Method:**  
- Uses advanced **NTLM reflection techniques**  
- Bypasses more **recent Microsoft mitigations**  

**Best Use Case:**  
- Highly restricted environments
- When other Potato exploits are blocked

---

## Summary Table

| Attack Variant   | SeImpersonate | SeAssignPrimaryToken | SeIncreaseQuota | SeTcb            |
| ---------------- | ------------- | -------------------- | --------------- | ---------------- |
| **PrintSpoofer** | Required      | Required             | ❌               | ❌                |
| **SigmaPotato**  | Required      | ❌                    | ❌               | ❌                |
| **RoguePotato**  | Required      | Required             | Recommended     | ❌                |
| **JuicyPotato**  | Required      | Sometimes Needed     | Helps Stability | ❌                |
| **SweetPotato**  | Required      | ❌                    | ❌               | ❌                |
| **BadPotato**    | Required      | ❌                    | ❌               | Sometimes Needed |

---

## Key Takeaways
- **SeImpersonatePrivilege is always required**  
- **SeAssignPrimaryTokenPrivilege is needed when creating new SYSTEM processes**  
- **SeIncreaseQuotaPrivilege improves stability but isn't always required**  
- **Windows mitigations have broken JuicyPotato, but newer Potato exploits still work**  
